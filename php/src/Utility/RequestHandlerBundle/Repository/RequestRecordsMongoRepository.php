<?php

namespace Utility\RequestHandlerBundle\Repository;

use Doctrine\ODM\MongoDB\DocumentRepository;

/**
 * RequestRecordsMongoRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class RequestRecordsMongoRepository extends DocumentRepository
{
    /**
     * retrive the results sorted by ids desc
     * @return array
     */
    public function findRequestRecords($limit_start, $limit_size) {
        $qb     = $this->createQueryBuilder('u');
        $result = $qb->sort('id', 'desc')
                     ->limit($limit_size)
                     ->skip($limit_start)
                     ->getQuery()
                     ->execute()
                     ->toArray(false);
        return $result;
    }
    
    /**
     * count the records.
     * @return int $result_count
     */
    public function findRequestRecordsCount() {
        $qb     = $this->createQueryBuilder('u');
        $result_count = $qb->getQuery()
                           ->execute()->count();
        return $result_count;
    }
}