<?php

namespace Utility\MasterDataBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * CountryCodeRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class CountryCodeRepository extends EntityRepository
{
    
    /**
     *  function for getting the record having status not equals to 0 and based on contry_code
     * @param type $country_code
     * @return type
     */
    public function getRecordByCountryCode($country_code) {
        //initialise the array
        try {
            $result = array();
            //create the query
            $query = $this->createQueryBuilder('c');
            $result = $query->select('c')
                    ->where('c.status != :status')
                    ->andWhere('c.languageCode = :language_code')
                    ->setParameter('status', 0)
                    ->setParameter('language_code', $country_code)
                    ->getQuery()
                    ->getResult();
            return $result;
        } catch (\Exception $ex) {
            return array();
        }
    }
    
     /**
    * Education List
    * @return object array
    */
    public function getCountryCodeList($langCode){ 
        try{
        //object of query builder.
        $qb = $this->createQueryBuilder('c');
        $query = $qb->select('c.id, c.countryCode, code.countryString as language_string')
                ->innerJoin('MasterDataBundle:CountryCodeByLang', 'code', 'WITH', 'code.countryCode = c.countryName')
                ->where('code.langCode =:langCode','c.status =:status')
                ->setParameter('langCode',$langCode )
                ->setParameter('status',1)
                ->getQuery();
        $response = $query->getResult();
        return $response;
        }catch(\Exception $e){
            return array();
        }
    }

}
